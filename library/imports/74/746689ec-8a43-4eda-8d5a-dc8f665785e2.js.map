{"version":3,"sources":["assets\\Script\\views\\cup.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { AudioEnum, AudioUtil } from \"../utils/audio_util\";\r\nimport { createTexture } from \"../utils/function\";\r\nimport Water, { WaterInfo } from \"./water\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nexport let WaterColors = [\r\n    \"#155DEF\",\r\n    \"#F2C90F\",\r\n    \"#BD2656\",\r\n    \"#F0791F\",\r\n    \"#454574\",\r\n    \"#FE2D26\",\r\n    \"#BCA6E3\",\r\n    \"#E4584F\",\r\n    \"#00B38A\",\r\n    \"#DD2E44\",\r\n    \"#E5C69A\",\r\n    \"#65DC8E\",\r\n    \"#B068F0\",\r\n    \"#F010BF\",\r\n    \"#538849\",\r\n]\r\n\r\n/**高度乘数因子，满杯水只显示80% */\r\nconst HEIGHT_FACTOR = 0.8;\r\n\r\n/**一杯水，分成四组四个颜色，0表示没有水 */\r\nexport interface _CupInfo{\r\n    colorIds:Array<number>;//长度为4\r\n}\r\n\r\nconst SPLIT_COUNT = 4;\r\n\r\n@ccclass\r\nexport default class Cup extends cc.Component {\r\n    @property(Water)\r\n    private water:Water = null;\r\n\r\n    private onClick:(c:Cup)=>void = null;\r\n\r\n    onBtn_click(){\r\n        if(this.isPouring()){\r\n            return;\r\n        }\r\n        if(this.onClick){\r\n            this.onClick(this);\r\n        }\r\n    }\r\n\r\n    public isPouring(){\r\n        return Math.abs(this.node.angle)>1.0;\r\n    }\r\n\r\n    initWater(){\r\n        const info = this.info;\r\n        let arr = [];\r\n        for(let i=SPLIT_COUNT-1;i>=0;i--){\r\n            let colorId = info.colorIds[i];\r\n            if(colorId==0){\r\n                continue;\r\n            }\r\n            let lastObj = arr[arr.length-1];\r\n            if(!lastObj||lastObj!=colorId){\r\n                arr.push({\r\n                    height:1/SPLIT_COUNT,\r\n                    colorId:colorId\r\n                });\r\n            }else{\r\n                lastObj.height += 1/SPLIT_COUNT;\r\n            }\r\n        }\r\n        arr.forEach(function (obj) {\r\n            let hex = WaterColors[obj.colorId]||\"#538849\"\r\n            // cc.log(\"obj.colorId\",obj.colorId,\"color\",hex)\r\n            obj.color = new cc.Color().fromHEX(hex);\r\n            obj.height*=HEIGHT_FACTOR;\r\n        })\r\n        \r\n        this.water.initInfos(arr);\r\n    }\r\n\r\n    private info:_CupInfo = null;\r\n    setCupInfo(info:_CupInfo,onClick:(c:Cup)=>void){\r\n        this.info = info;\r\n        this.onClick = onClick;\r\n        \r\n        this.initWater();\r\n        \r\n        this.reset();\r\n    }\r\n\r\n    update(){\r\n        if(CC_EDITOR){\r\n            return;\r\n        }\r\n        if(this.water.skewAngle==this.node.angle){\r\n            return;\r\n        }\r\n        this.water.skewAngle = this.node.angle;\r\n    }\r\n\r\n    private setPourOutCallback(pourStart,pourEnd){\r\n        //水开始从瓶口流出来\r\n        const _onStart = function(){\r\n            if(pourStart){\r\n                pourStart(this)\r\n            }\r\n            \r\n        }\r\n        //水倒完了\r\n        const _onFinish = function(){\r\n            if(this.tween){\r\n                this.tween.stop();\r\n                this.tween = null;\r\n            }\r\n            if(pourEnd){\r\n                pourEnd(this)\r\n            }\r\n        }\r\n        this.water.setPourOutCallback(_onStart.bind(this),_onFinish.bind(this));\r\n    }\r\n\r\n    private setPourInCallback(onFinish){\r\n        //水倒完了\r\n        const _onFinish = function(){\r\n            let isFinished = this.checkIsFinshed();\r\n            // cc.log(\"-----------isFinished\",isFinished)\r\n            if(onFinish){\r\n                onFinish(this,isFinished)\r\n            }\r\n            if(isFinished){\r\n                AudioUtil.playEffect(AudioEnum.finishOne,0.4)\r\n            }\r\n        }\r\n        this.water.setPourInCallback(_onFinish.bind(this));\r\n    }\r\n\r\n    /**是否完成了（同颜色填满整个杯子） */\r\n    checkIsFinshed(){\r\n        let isFinished = true;\r\n        let colorIds = this.info.colorIds;\r\n        let tmpId = null;\r\n        let empTyNum = 0;\r\n        for(let i=0;i<SPLIT_COUNT;i++){\r\n            if(tmpId==null){\r\n                tmpId = colorIds[i]\r\n            }\r\n            if(tmpId!=colorIds[i]){\r\n                isFinished = false;\r\n                break;\r\n            }else if(colorIds[i]==0){\r\n                empTyNum++;\r\n            }\r\n        }\r\n        if(empTyNum==SPLIT_COUNT){\r\n            isFinished = true;\r\n        }\r\n        return isFinished;\r\n    }\r\n\r\n    private tween:cc.Tween = null;\r\n    /**\r\n     * 移动到目标点、旋转瓶子并倒水\r\n     * @param isRight 倾斜角度，向左为正，右为负\r\n     * @param onPourStart 水开始从瓶口流出来\r\n     * @param onPourEnd 本次水倒完了\r\n     */\r\n    moveToPour(dstPt:cc.Vec2,isRight:boolean,onPourStart:(c:Cup)=>void,onPourEnd:(c:Cup)=>void){\r\n        this.setPourOutCallback(onPourStart,onPourEnd);\r\n\r\n        let startAngle = this.water.getPourStartAngle()\r\n        let endAngle = this.water.getPourEndAngle()\r\n\r\n        this.water.onStartPour();\r\n        if(isRight){\r\n            startAngle*=-1;\r\n            endAngle*=-1;\r\n        }\r\n\r\n        let moveDur = 0.5;\r\n        let pourDur = 0.8;\r\n\r\n        this.tween = cc.tween(this.node)\r\n            .set({angle:0})\r\n            .to(moveDur,{x:dstPt.x,y:dstPt.y,angle:startAngle})\r\n            .to(pourDur,{angle:endAngle})\r\n            .call(()=>{\r\n                this.tween = null;\r\n            }).start();\r\n\r\n        let top = this.getTop();\r\n        let colorIds = this.info.colorIds;\r\n        for(let i=0;i<SPLIT_COUNT;i++){\r\n            let _id = colorIds[i]\r\n            if(_id==0){\r\n                continue;\r\n            }else if(top.topColorId==_id){//顶部相同颜色的水都倒掉了\r\n                colorIds[i] = 0;\r\n            }else{\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    startAddWater(colorId:number,num:number,onComplete:(cup:Cup,isFInish:boolean)=>void){\r\n        this.setPourInCallback(onComplete);\r\n        let acc = 0;\r\n        for(let i=SPLIT_COUNT-1;i>=0;i--){\r\n            if(this.info.colorIds[i]!=0){\r\n                continue;\r\n            }\r\n            this.info.colorIds[i] = colorId;\r\n            if(++acc==num){\r\n                break;\r\n            }\r\n        }\r\n        let hex = WaterColors[colorId]||\"#538849\"\r\n        this.water.addInfo({\r\n            colorId:colorId,\r\n            height:num/SPLIT_COUNT *HEIGHT_FACTOR,\r\n            color:new cc.Color().fromHEX(hex)\r\n        });\r\n\r\n        AudioUtil.playPourWaterEffect(num/SPLIT_COUNT);\r\n    }\r\n\r\n    /**加水立刻 */\r\n    addWaterImmediately(colorId:number,num:number){\r\n        let acc = 0;\r\n        for(let i=SPLIT_COUNT-1;i>=0;i--){\r\n            if(this.info.colorIds[i]!=0){\r\n                continue;\r\n            }\r\n            this.info.colorIds[i] = colorId;\r\n            if(++acc==num){\r\n                break;\r\n            }\r\n        }\r\n        this.initWater();\r\n    }\r\n\r\n    /**将顶部的颜色删除num个 */\r\n    removeTopWaterImmediately(num:number){\r\n        let acc = 0;\r\n        let top = this.getTop();\r\n        let colorIds = this.info.colorIds;\r\n        for(let i=0;i<SPLIT_COUNT;i++){\r\n            let _id = colorIds[i]\r\n            if(_id==0){\r\n                continue;\r\n            }else if(top.topColorId==_id){//顶部相同颜色的水都倒掉了\r\n                colorIds[i] = 0;\r\n                if(++acc>=num){\r\n                    break\r\n                }\r\n            }else{\r\n                break;\r\n            }\r\n        }\r\n        this.initWater();\r\n        return top;\r\n    }\r\n\r\n    getTop(){\r\n        let colorIds = this.info.colorIds;\r\n        let emptyNum = 0;//杯顶的空位有几格\r\n        let topColorId = 0;//杯顶颜色id\r\n        let topColorNum = 0;//杯顶的颜色共有几格\r\n        for(let i=0;i<SPLIT_COUNT;i++){\r\n            if(colorIds[i]==0){\r\n                emptyNum++;\r\n                continue;\r\n            }\r\n            if(topColorId==0||topColorId==colorIds[i]){\r\n                topColorId = colorIds[i];\r\n                topColorNum++;\r\n            }else{\r\n                break;\r\n            }\r\n        }\r\n        return {\r\n            emptyNum:emptyNum,\r\n            topColorId:topColorId,\r\n            topColorNum:topColorNum,\r\n            colorHex:WaterColors[topColorId]||\"#538849\"\r\n        }\r\n    }\r\n\r\n    reset(){\r\n        this.node.angle = 0;\r\n        this.water.skewAngle = 0\r\n    }\r\n\r\n    public setPourAnchor(isRight:boolean){\r\n        let pt = cc.v2(3,2);\r\n        pt.x = isRight?(this.node.width-pt.x):pt.x;\r\n        pt.y = this.node.height-pt.y;\r\n        \r\n        pt.x = pt.x/this.node.width;\r\n        pt.y = pt.y/this.node.height;\r\n\r\n        this.setAnchor(pt) \r\n    }\r\n\r\n    public setNormalAnchor(){\r\n        this.setAnchor(cc.v2(0.5,0.5))\r\n    }\r\n\r\n    private dot:cc.Node = null;\r\n    private setAnchor(anchor:cc.Vec2){\r\n        // if(this.dot==null){\r\n        //     this.dot = new cc.Node();\r\n        //     this.dot.parent = this.node;\r\n        //     let label = this.dot.addComponent(cc.Sprite);\r\n        //     label.spriteFrame = new cc.SpriteFrame(createTexture())\r\n        //     this.dot.color = cc.Color.RED;\r\n        // }\r\n        // this.dot.setPosition(0,0)\r\n\r\n        let oldAnchor = this.node.getAnchorPoint();\r\n        let selfPt = this.node.getPosition();//当前锚点世界坐标\r\n        \r\n        let waterPt = this.water.node.getPosition();\r\n        this.node.setAnchorPoint(anchor);\r\n        let offsetAnchor = cc.v2(anchor.x-oldAnchor.x,anchor.y-oldAnchor.y)\r\n        let offsetPt = cc.v2(offsetAnchor.x*this.node.width,offsetAnchor.y*this.node.height)\r\n        offsetPt = rotatePt(offsetPt,this.node.angle)\r\n        selfPt.x += offsetPt.x;\r\n        selfPt.y += offsetPt.y;\r\n        this.node.setPosition(selfPt);\r\n        waterPt.x -= offsetAnchor.x*this.node.width;\r\n        waterPt.y -= offsetAnchor.y*this.node.height;\r\n        this.water.node.setPosition(waterPt);\r\n\r\n    }\r\n\r\n    /**获取当前水面的global y坐标 */\r\n    getWaterSurfacePosY(needAdjust=false){\r\n        let top = this.getTop();\r\n        let y = (SPLIT_COUNT-top.emptyNum)/SPLIT_COUNT;\r\n        if(y<0.02){\r\n            y = 0.02\r\n        }else if(needAdjust){\r\n            y-=1.0/SPLIT_COUNT*HEIGHT_FACTOR;\r\n        }\r\n        y*=HEIGHT_FACTOR;\r\n        y-=0.5;\r\n        let pt = cc.v2(0,this.water.node.height*y);\r\n        pt = this.water.node.convertToWorldSpaceAR(pt)\r\n        return pt.y\r\n    }\r\n}\r\n\r\nfunction rotatePt(pt:cc.Vec2,angle:number){\r\n    let radian = angle2radian(angle);\r\n    let ret = cc.v2();\r\n    ret.x = pt.x*Math.cos(radian)-pt.y*Math.sin(radian);\r\n    ret.y = pt.x*Math.sin(radian)+pt.y*Math.cos(radian);\r\n\r\n    return ret;\r\n}\r\n\r\nfunction angle2radian(angle:number){\r\n    while(angle>360){\r\n        angle-=360;\r\n    }\r\n    while(angle<-360){\r\n        angle+=360;\r\n    }\r\n    return (angle%360) * Math.PI / 180.0;\r\n}"]}